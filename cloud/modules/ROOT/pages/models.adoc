= Create Models
:last_updated: 3/28/2024
:linkattrs:
:experimental:
:page-layout: default-cloud-early-access
:description: Models are logical views created on top of a more complex data model, to enable business users to more easily consume data.
:model: Model
:jira: SCAL-158357, SCAL-194041 (9.12.5 -drag to create joins), SCAL-194038 (9.12.5 - bulk edit column properties).

== Introducing Models

Models are a new, easier way of creating what previously were called Worksheets. You can create Models from the *Data* tab, just like Worksheets. You can still create and use Worksheets, but ThoughtSpot plans to deprecate and remove Worksheets in a future release. All worksheets can be migrated to Models in a future release.

Models are created in the new Model editor which provides a more visual and intuitive experience for creating data models.

Benefits of the Model editor include:

- Building a data model visually, by dragging and dropping tables and columns
- Creating joins between tables is faster and easier
- Using the tabbed interface allows you to quickly switch between table and column views, as well as formulas, filters, parameters, and settings.

=== Limitations

You can create either Models or Worksheets, however you cannot do the following:

- Switch an individual Worksheet to a Model
- Switch all Worksheets to Models in a cluster
+
NOTE: When the {model} feature is available to all customers by default in a future release, you will have the option to request ThoughtSpot to migrate all the Worksheets on your cluster to {model}s.

////
=== About Models

Models are logical views of data which allow you to model complex datasets. These data models simplify access to data for end-users and application services by incorporating these key features, and more:

* *Table joins* supplement the primary data with information from various other data sources.
* *Changing data types* ensures that you can handle mismatches gracefully, For example, conversions of date/time type formats, and processing of numeric codes (such as event IDs) correctly.
* *Derived fields* support flexible expressions and formulas.
* *Renamed fields* make charts and tables easily accessible.
* *Selecting fields* allows you to focus only on the  fields that are necessary to the business use case.
* *Hiding fields* lets you change the visibility of data by obscuring and securing sensitive information without affecting the calculations that depend on it.
+
NOTE: If a hidden column is used in an Answer pinned to a Liveboard, then the entire Liveboard becomes read-only to users. This limits Liveboard functionality, which means the ability to adjust filters and download data is restricted.
* *Changing the default aggregation* of fields in a {model} prevents common mistakes when building visuals.


After xref:data-modeling.adoc[modeling your data], create {model}s to make searching easier.
For example, a sales executive might need to search for information about retail sales.
This data might be contained in several tables (sales, customers, products, stores, etc.), with foreign key relationships between them.
An administrator who is familiar with the data model can create a retail sales {model}, that combines all of the related fact and dimension tables into a single, easy-to-use view, and share it with the sales executive.
This provides access to the data without requiring an understanding of how it is structured.
////
[#create-model]
== Creating a {model}

To create a data model:

. Select *Data* on the top navigation bar.
. Select the *+ Create new* button in the side navigation bar.
. Select *Model*.
+
image::model_choose.png[Choose how to model your data]



. Choose how you want to model your data, using one of the following options:
.. To create your own model, select *Build your own with cloud data*.
... To create a new connection, refer to xref:connections.adoc[About connections]
... To use an existing connection, select it from the list, and select *Connect*.
.. To build a model from tables originally created from dbt models, select *dbt*
... To create a new dbt connection, select *Add dbt connection* and refer to step 5 of xref:dbt-integration.adoc#integrate[Integrating with dbt].
... To use an existing connection, select it from the list, and select *Connect*.
.. To import the TML for a model, select *TML*, and upload your tml files. For more information, refer to xref:tml-worksheets.adoc[TML for Worksheets].
+
NOTE: The information at this link also applies to {model}s.
.. To use an existing SpotApp as a model, select *SpotApps*, and select a SpotApp.

. <<build-model,Build your data model>>.

.[.badge.badge-early-access]#Early Access#
****
If you are not able to see the Models feature, contact your ThoughtSpot administrator to enable it. For more about Early Access features, see xref:release-lifecycle.adoc#early-access[ThoughtSpot Cloud release life cycle].
****

[#build-model]
== Building your {model}

After creating your {model}, you need to add the sources that contain the data.
A source is another name for a table. You do that using the {model} editor. If you chose an existing model, you can make changes to your model.

image::model_empty.png[Create a Model]

The sources you choose are typically related to one another by foreign keys.

The first step to building your {model}, is to add tables.

=== Adding tables

To add tables to your {model}, do the following:

. Drag tables from the list on the left, and drop them into the right pane.
+
image::model_tables.png[Model populated with tables]


==== Suggested joins

If the tables you added to your {model} were joined previously, a join suggestion appears.

image::model_tables_join_suggestion.png[Suggested join between tables]

You can choose whether to keep, modify or remove the suggested join.

- Click the join icon image:model_join_icon.png[join icon], then select one of the following options:
.. To keep the join, click *Accept Join*.
.. To modify the join, click *Edit Join*.
... Make your changes and click *Save*. For more information, see step 2 of <<add-joins,Adding joins>>.
.. To remove the join, click *Clear Join*.

[#add-joins]
=== Adding joins
. To add a new join between tables, do one of the following:

- Select the More menu image:model_table_join_more.png[Model more menu] in the upper right of a table, and select *Add Join*.
- Hover over the table until you see a *\+* appear on the edge of the table, then click the *+* and drag to the table you want to join.
. In the _Create Join_ window for _Table 2_, select the table you want to join to the first table (_Table 1_).
. For _Column from Table 1_, select the column you want to join to another column in _Table 2_.
. For _Column from Table 2_, select the column in _Table 2_ which you want to join to the selected column in _Table 1_.
. For _Join Type_, select a join type. Options include:
- INNER image:model_join_icon.png[inner join]
- FULL OUTER image:model_join_full_outer_icon.png[outer join]
- LEFT OUTER image:model_join_suggestion_icon.png[left outer join]
- RIGHT OUTER image:model_join_right_outer_icon.png[right outer join]
. For _Cardinality_, select the cardinality. Options include:
- Many:1
- 1:Many
- 1:1
. Click *Save*.
+
The join is created.
+
image::model_tables_joined.png[Join created]

. Add additional tables and joins, as needed.
. (Recommended) Name your {model} by clicking *Add name* and entering a name.
. (Optional) Add a description of your {model} by clicking *Add description* and entering a description.
. When you are finished adding tables and joins to your {model}, the next step is to add columns.

==== Global and local joins

{model}s support both global and local joins. It's helpful to understand the difference.

- *Global joins* are created between two tables in a connection and they are available to any {model} created in that connection. If you see a join suggestion when you create a model, it means that join is a global join.
- *Local joins* are created in a specific {model} and they are only available in that {model}.

=== Adding columns

To add columns to your {model}, do the following:

. Click the *Columns* tab.
+
image::model_columns.png[Model columns tab]
+
Table names are highlighted in blue, and their associated columns appear underneath them.

. Add columns by doing either of the following:
- To add all the columns from a table, drag the table name from the list on the left and drop it into the right pane.
- To add an individual column from a table, drag the column name from the list on the left and drop it into the right pane.

+
image::model_columns_added.png[Columns added to Model]

. (Optional) Edit column properties, using either of the following methods:
.. For an individual column:
... Click the column property you want to edit, and make your changes.
.. For multiple columns:
... Click the checkbox next to the columns you want to edit.
... Click the *Edit* menu, and select the property you want to edit.
... In the window that opens, select the option you want and click *Update*.
. To save the columns in your {model}, select *Save changes*.
+
You are prompted to edit the title and description of your {model}.
. Edit the title and description if needed.
. Click *Save*.
+
Your model is saved, and you have the option to add formulas, filters, parameters, and adjust settings.
. If you don't want to add those now, select *Exit data model*.

=== Adding formulas

To add formulas to your {model}, do the following:

. Click the *Formulas* tab.
. Click *Add Formula*.
+
. Create a name for your formula.
. Enter a formula, using the formula assistant (at right) if needed.
+
image::model_formulas_2.png[Formula editor]
+
With the formula assistant, you can see a list of formula operators with examples.
+
If you want to change what your formula returns, select the Advanced settings button image:icon_formula_gear_32px.png[gear icon].
+
Depending on your formula, you may be able to change:

- Data type: Determines the type of data that the formula generates. For example, use date for an add_days formula.
- Measure or attribute: Determines if the output of the formula is a measure or an attribute. For example, choose attribute for a formula that generates age groups, and choose measure for a formula that generates profit.
- Aggregation: Determines the default aggregation of the formula output. For example, choose min to see minimum profit.

. Click *Save*.
. Click *Save changes*.

=== Adding filters

To add filters to your {model}, do the following:

. Click the *Filters* tab.
. Click *Add filter*.
. Choose the column you want to filter on.
+
image::model_filters.png[Choose column]
. Select the values to include in your Answer.
+
image::model_filters_2.png[Select values]
. If you want to exclude values, select *Exclude* and choose values to exclude.
+
You can also include values in bulk, by clicking *+ Add values in bulk*, and adding values separated by a comma (,) or a semicolon (;) or by putting them on separate lines.
. Click *Submit*.
. Click *Save changes*.

=== Adding parameters

To add parameters to your {model}, do the following:

. Click the *Parameters* tab.
. Click *Add Parameter*.
+
image::model_parameters.png[Edit parameter]
. In the _Parameter name_ text box, enter a name for your Parameter. This name should be unique for the object, and easy for users to understand.
. Optionally, enter a description for the Parameter in the _Add a description_ text box. Use this field to add additional information users might need before using this Parameter in their analysis. It is a best practice to use this field to specify the formulas this Parameter is used in, in addition to any other information you add.
. Under _Data settings_, specify the data type the Parameter must be: Integer, Double, String, Boolean, or Date. For more information about data types, refer to xref:data-types.adoc[Data types].
. For integer, double, or date data types, specify the allowed values: Any, List, or Range. For the string data type, specify either _Any_ or _List_.
+
[horizontal]
Any::
Allows any value within the data type's constraints.
List:: Allows values only in the list you create. Enter a value in the *Enter value...* text box, and optionally enter what the value should display as in the *Display as...* text box. To add more values, select *+ Add row*. To delete values, select the *x* to the right of the row the value is in.
+
image::parameter-list.png[Create a list of allowed values]
Range:: Allows values only within the range you specify. In the *Minimum value* and *Maximum value* text boxes, specify the values the range begins and ends with.
+
image::parameter-range.png[Create a range of allowed values]
. For the boolean data type, optionally set custom names for `true` and `false`; for example, `0` and `1`.
. Set the default value for your Parameter. In the default value text box, enter the value this Parameter should default to. For the boolean data type, the *Default value* option is a dropdown.  `true` and `false` are the only options.
. Select *Save*.

=== Settings

You can set properties for your model, including join rules and security.

To set properties for your {model}, do the following:

. Click the *Settings* tab.
. For _Data model join rule_ choose one of the following:
- Apply joins progressively (recommended for most cases)
- Apply all joins
. For _Security_ you have the option to disable row level security for your data model.
+
image::model_settings.png[Model settings]
. Click *Save changes*.

==== Understanding progressive joins

Often, a {model} includes several dimension tables and a fact table.
With progressive joins, if your search only includes terms from the fact table, you can see all of the rows that satisfy your search.
But as you add terms from dimension tables, the total number of rows shown may be reduced, as the joins to each dimension table are applied.
It works like this:

* If you choose *Apply joins progressively (recommended for most cases)*, joins are only applied for tables whose columns are included in the search.
* If you choose *Apply all joins*, all possible joins are applied, regardless of which tables are included in the search.

When using *Apply joins progressively*, the number of rows in a search using the {model} depends on which tables are part of the search.
The {model} contains the results of a defined query in the form of a table.
So if a particular dimension table is left out of the search, its joins are not applied.

== Editing a {model}

If you created a {model}, or you have edit permissions on it, you can make changes such as adding sources and columns, adding or editing formulas, changing relationships, and changing column names. You can also rename a {model} or change its description.

To edit a {model}:

. Select *Data* on the top navigation bar.
. Select the name of the {model} you want to edit.
. Select the *Edit Worksheet* button in the upper-right of the screen.
+
NOTE: Even though the button currently says _Edit Worksheet_, it allows you to edit a {model} if you selected one in the previous step.
. Make your changes to the {model}.
+
****
*Edit tables*

Using the More menu image:model_table_join_more.png[Model more menu] in the upper right of a table, you can edit a table in the following ways:

- Add Join
- Rename table
- Duplicate table
- Remove table
- Show Join Recommendation
****
+
****
*Edit columns*

You can edit columns in the following ways:

- Add columns by dragging and dropping them
- Edit fields in columns
- Delete any column by checking it and selecting *Delete*
****
+
****
*Edit formulas, filters, parameters, and settings*

You can edit in the following ways:

- Delete formulas, filters, and settings
- Modify properties
****

. Select *Save changes*.

== Making a copy of a {model}

To make a copy of a {model}:

. Select *Data* on the top navigation bar.
. Select the name of the {model} you want to make a copy of.
. Open the *More* menu image:icon-more-10px.png[more menu icon] and select *Make a copy*.

+
The *make a copy* dialog appears.

. Change the name and description, as needed, and select *Save*.
+
When you navigate back to the Worksheet page, your new {model} name appears in the list.
+
NOTE: Even though the page currently only uses the term _Worksheet_, it does show both Worksheets and Models. Any models will appear in the list of Worksheets.


[#role-playing-dimensions]
== Role-playing dimensions

A role-playing dimension is when a single physical dimension is referenced multiple times in a fact table, with each reference linking to a logically distinct role for the dimension. ThoughtSpot supports role-playing dimensions for {model}s. For example, you may have a fact table joined to a dimension table more than once. This is useful for cases such as when you have a sales fact table and an employee dimension table, where the sales table may record the employee ID who created, updated, and owned a record. In this case, you would want to join these three columns to the employee dimension table on employee ID.

=== Implementing role-playing dimensions with {model}s

To implement role-playing dimensions with Models, do the following in the Model editor:

. Go to the *Tables* tab.
. Select the More menu image:model_table_join_more.png[Model more menu] in the upper right of  the dimension table that you want to use in a different role.
. Select *Duplicate Table*.
. In the _Duplicate Table Name_ window that opens, assign an alias (since 2 tables cannot have the same name) by entering a new name (or alias) for that table.
. Click *Save*.
. Join this logical copy of the dimension table to the fact table with the join condition corresponding to the new role.
+
. Go to the *Columns* tab.
. Add columns from the new role-playing dimension.
+
It will appear as a new table (with the alias assigned in step 4) on the left panel in the *Columns* tab of the model. You can tell it's a role-playing dimension because the original table name appears in parentheses *()* next to the new name.

CAUTION: Copies/aliases of tables that are on the "many" side of a join are not supported in {model}s.