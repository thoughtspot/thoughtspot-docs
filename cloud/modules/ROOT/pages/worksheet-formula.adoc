= Create a formula in a Worksheet
:last_updated: 3/20/2020
:linkattrs:
:experimental:
:page-layout: default-cloud
:page-aliases: /admin/worksheets/create-formula.adoc
:description: You can define formulas and use them to create derived columns in Worksheets.


You create formulas by combining standard functions and operators, column names, and constant values.

Anyone who can create a Worksheet can add a formula to it.
Formulas are not reusable;
the formula you create is associated only with the Worksheet it belongs to.
A complete list of available formulas and examples of each is available in the xref:formula-reference.adoc#[Formula function reference].

You can create a formula in a Worksheet by using the Formula Builder.
When you do this, the result of the formula gets added to the Worksheet as a column.
Use these steps to create a formula:

. xref:worksheets.adoc[Create a new Worksheet], or xref:worksheet-edit.adoc[edit an existing one].
. Select the *+* button next to *Formulas*.
+
image::worksheet-add-formula.png[Create a new formula for your Worksheet]

. Type your formula in the Formula Builder.
+
image::worksheet-formula-profit-old.png[Use the Formula Builder]
+
NOTE: Formula elements are color coded by type and can include the formula operators and functions (blue), the names of columns (purple), and/or constants (black).

. You can see a list of formula operators with examples by selecting on *Formula Assistant.*
+
image::worksheet-formula-assistant-old.png[Formula Assistant]

. If you want to change what your formula returns, use the *Advanced settings*.
+
Depending on your formula, you may be able to change:

 ** *Data type*: Determines the type of data that the formula generates.
For example, use `date` for an `add_days` formula.
 ** *Measure or attribute*: Determines if the output of the formula is a measure or an attribute.
For example, choose `attribute` for a formula that generates age groups, and choose `measure` for a formula that generates profit.
 ** *Aggregation*: Determines the default aggregation of the formula output.
For example, choose `min` to see minimum profit.

+
image::worksheet-formula-settings-old.png[Advanced settings in the Formula Builder]

. Name the formula by selecting on its title and typing the new name.
Select *Save*.

'''
> **Related information**
>
> * xref:worksheet-edit.adoc[Edit a Worksheet]
> * xref:worksheet-filter.adoc[Create a Worksheet filter]
> * xref:worksheet-progressive-joins.adoc[How the Worksheet join rule works]
> * xref:worksheet-inclusion.adoc[Create join rule or RLS for a Worksheet]
> * xref:join-add.adoc[Create a join relationship]
> * xref:join-worksheet-edit.adoc[Modify joins between Worksheet tables]
> * xref:worksheet-delete.adoc[Delete Worksheets or tables]
> * xref:scriptability.adoc[Migrate or restore Worksheets]
> * xref:tml.adoc[Worksheet TML specification]
