= Add a formula to a search
:last_updated: 9/7/2022
:linkattrs:
:experimental:
:page-layout: default-cloud
:page-aliases: /complex-search/how-to-add-formula.adoc
:description: Learn how to add a formula to a search.

You can add a formula directly within a search.
Some common reasons for using a formula in a search are to perform mathematical functions, check for and replace null values, or add conditional logic.

== Adding a formula to a search

To create a formula in a search:

. Start a new search, or choose an existing Answer to edit.
. Open the Data panel from the upper-right corner if it is not open, and select the *+* icon next to Formulas.
If the xref:answer-experience-new.adoc[new Answer experience] is off in your environment, select the *more options* icon image:icon-more-10px.png[more options menu icon] in the upper-right side of the table, and select *Add formula*.
+
image::formula-editor-add.png[Click + to add a formula]

. Name and enter your formula in the Formula Editor.
The new Formula Editor supports multi-line wrapping of long formulas.
To continue the formula on a new line, press *Enter* or *return* on your keyboard. The Editor displays suggestions after you enter at least one character.
+
image::worksheet-formula-profit.png[Use the Formula Editor]
+
NOTE: Formula elements are color-coded by type and can include the formula operators and functions (blue), the names of columns (purple), the names of Parameters (green), and/or constants (black).

. You can see a list of formula functions or operators with examples by selecting the help icon *?* in the upper-right corner. Use the search bar to search for specific functions.
If the new Answer experience is off in your environment, select *Formula Assistant*.
Expand a category, such as *Comparison*, and select a formula operator for a definition and example.
+
image::formula-assistant.png[Formula Editor help]

. To change what your formula returns, use the *Advanced settings*.
Select the settings icon image:icon-gear-10px.png[Chart configuration icon image] in the upper-right corner.
If the new Answer experience is off in your environment, select *Settings*.
Depending on your formula, you may be able to change the following aspects:
 ** *Data type*: Determines the type of data that the formula generates.
For example, use `date` for an `add_days` formula.
 ** *Measure or attribute*: Determines if the output of the formula is a measure or an attribute.
For example, choose `attribute` for a formula that generates age groups, and choose `measure` for a formula that generates profit.
 ** *Aggregation*: Determines the default aggregation of the formula output.
For example, choose `min` to see minimum profit.

+
image::worksheet-formula-settings.png[Advanced settings in the Formula Builder]
. Select *Save*.
Name your formula, if you did not already name it.

[#formula-experience-comparison]
== New and classic Formula Editor experiences

As part of the xref:answer-experience-new.adoc[new Answer experience], we redesigned the Formula Editor. You may notice the following differences between the new Formula Editor, and the Formula Editor in the classic Answer experience:

=== New Formula Editor
* Supports multiline formulas and indentation
* Smoother, faster, and more bug-free
* You see completions after you start typing. This allows users to add new lines more easily between tokens.
* Redesigned right panel houses both the formula settings and the help panel
* Search for specific keywords in the help panel
* The formula operator sections in the help panel are more intuitively organized and easier to navigate

=== Classic Formula Editor
* Supports only single-line formulas
* May not be as fast as the new Formula Editor
* You see completions before you start typing
* The right panel houses the help panel, but the formula settings are at the lower section of the Formula Editor
* No ability to search for specific keywords in the help panel
* The formula operator sections in the help panel may be harder to navigate

'''
> **Related information**
>
> * xref:formula-reference.adoc#[Formula function reference]
