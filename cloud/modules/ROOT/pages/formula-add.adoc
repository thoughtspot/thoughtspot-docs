= Add a formula to a search
:last_updated: 4/1/2021
:linkattrs:
:experimental:
:page-layout: default-cloud
:page-aliases: /complex-search/how-to-add-formula.adoc
:description: Learn how to add a formula to a search.

NOTE: The new formula editor is part of the xref:answer-experience-new.adoc[new answer experience].
The new answer experience is in Beta and off by default, but the option to turn it on or off individually is on by default.
If you have the new answer experience on, the new version of the Formula Editor appears when you add a formula to a search, but not when you add a formula to a Worksheet.
You can turn the new answer experience on or off individually from the *Experience manager* panel in your profile.
If that option is not available, contact your administrator.

You can add a formula directly within a search.
Some common reasons for using a formula in a search are to perform mathematical functions, check for and replace null values, or add conditional logic.

== How to add a formula

To create a formula in a search:

. Start a new search, or choose an existing Answer to edit.
. Open the Data panel from the upper right corner if it is not open, and click the + icon next to Formulas.
If the xref:answer-experience-new.adoc[new answer experience] [.badge.badge-update]#Beta# (off by default) is off in your environment, click the *more options* icon image:icon-ellipses.png[more options menu icon] in the upper-right side of the table, and select *Add formula*.
+
image::formula-editor-add.png[Click + to add a formula]

. Name and enter your formula in the Formula Editor.
The new Formula Editor supports multi-line wrapping of long formulas.
To continue the formula on a new line, press *Enter* or *return* on your keyboard.
+
image::worksheet-formula-profit.png[Use the Formula Editor]
+
NOTE: Formula elements are color-coded by type and can include the formula operators and functions (blue), the names of columns (purple), and/or constants (black).

. You can see a list of formula operators with examples by selecting the help icon *?* in the upper right corner.
If the new answer experience [.badge.badge-update]#Beta# (off by default) is off in your environment, click *Formula Assistant*.
Expand a category, such as *Comparison*, and click on a formula operator for a definition and example.
+
image::worksheet-formula-assistant.png[Formula Editor help]

. To change what your formula returns, use the *Advanced settings*.
Select the settings icon image:icon-gear-10px.png[] in the upper right corner.
If the new answer experience [.badge.badge-update]#Beta# (off by default) is off in your environment, select *Settings*.
Depending on your formula, you may be able to change the following aspects:
 ** *Data type*: Determines the type of data that the formula generates.
For example, use `date` for an `add_days` formula.
 ** *Measure or attribute*: Determines if the output of the formula is a measure or an attribute.
For example, choose `attribute` for a formula that generates age groups, and choose `measure` for a formula that generates profit.
 ** *Aggregation*: Determines the default aggregation of the formula output.
For example, choose `min` to see minimum profit.

+
image::worksheet-formula-settings.png[Advanced settings in the Formula Builder]
. Click *Save*.
Name your formula, if you did not already name it.

== Related information

xref:formula-reference.adoc#[Formula function reference]
