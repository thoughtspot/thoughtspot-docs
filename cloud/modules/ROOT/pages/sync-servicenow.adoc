= Sync data from ThoughtSpot to ServiceNow
:last_updated: 2/8/2023
:author: Naomi
:linkattrs:
:experimental:
:page-layout: default-cloud
:description: You can connect ThoughtSpot to your Google account and push insights to ServiceNow.
:connection: ServiceNow
:jira: SCAL-176730, scal-201311

[#prerequisites]
== Prerequisites

Before you create a sync to {connection} from ThoughtSpot, sign in to {connection} to find your instance URL, Client Secret, and Client ID. You need this information to create the connection to send your data to {connection}.

=== Configure ServiceNow OAuth in ThoughtSpot

NOTE: OAuth must be activated in ServiceNow to use the app in ThoughtSpot. To activate ServiceNow OAuth, review the link:https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB0778194[setup documentation].

. From the ServiceNow Home tab, click *Prepare OAuth on ServiceNow*. You will be taken to the ServiceNow website.

. Create a new OAuth entry in your application registry.

. Create an *OAuth API endpoint for external clients*.

. Enter *ThoughtSpot* in the *Name* field.

. Users in the US region should configure the following redirect URL in the *Redirect URL field*: https://seekwell.dataplane-public.aws-us-east-1.thoughtspot.cloud/servicenow_save_oauth. +
Users in the EU region should use: https://seekwell.dataplane-public.aws-eu-central-1.thoughtspot.cloud/servicenow_save_oauth.

. ServiceNow will generate a *client ID* and *client secret*. Save these to connect ServiceNow to ThoughtSpot.

. Click *Submit*.


== Sync to {connection} from an Answer

To create a sync to {connection} from an Answer, follow these steps:

. Select the desired Answer from the *Answers* tab or the ThoughtSpot homepage. You must have *Can manage sync* permissions and *view* access to an Answer to create a sync.

. In the upper-right corner of the Answer, click the *more options* menu icon image:icon-more-10px.png[More options menu icon]. From the dropdown menu, select *Sync to other apps*, then choose *{connection}*.
+
//NOTE: You cannot create a sync from an unsaved Answer. If the *Sync to other apps* option appears grayed-out in the menu, first save the Answer before trying again.

. If this is the first sync you have created for {connection}, a pop-up authorization window appears. To give ThoughtSpot permission to send data to your {connection} account, fill out the *Instance url*, *Client id*, and *Client secret* found in the <<prerequisites,Prerequisites>>. In the authorization pop-up that appears, click *Allow*.
+
image::servicenow-instance.png[ServiceNow instance url, client id, client secret pop-up]


. Within ThoughtSpot, fill in the following parameters:

* Edit the *Pipeline name* if needed. By default, this field populates with _PL-[Answer Name]_.
* If you have more than one {connection} destination set up, then the *Destination* field appears, and you will have to select a {connection} destination from the dropdown available. However, if no destinations have been set up before or if you have only one {connection} destination, the *Destination* field will not appear.
* Select your {connection} *Object* from the dropdown menu. The available options are *Cases*, *Contacts*, *Incidents*, and *Tasks*.
* Select *Operation* from the dropdown menu. You can choose between *Create*, *Update*, and *Delete*.
+
NOTE: Not all objects will support all three operations.
* Map the *Source* and *Destination* columns from the dropdowns provided.
+
image:ts-sync-servicenow-param.png[{connection} Sync window]


. By default, "Save and sync" is selected. Select *Save* to send your data to {connection}. Your data immediately appears in {connection}.

. [Optional] To set up a repeated sync, click *Schedule your sync* and select your timezone. From the options provided, choose whether the sync will occur every:

* _n_ minutes. You can choose to schedule a sync every 5, 10, 15, 20, 30, or 45 minutes.
* _n_ hours.
* _n_ days at a selected time. Note that you can choose not to send an update on weekends.
* week at a selected time and day.
* _n_ months at a selected time and date.

NOTE: Any sync over 50,000 rows may result in an execution timeout. For optimal performance, keep your sync to below 50,000 rows. If you're syncing a large number of rows and the sync fails, try applying filters like date filters to make your dataset smaller and then sync.


=== Roles

To enable the Contact and Case objects requires the Customer Service plugin (com.sn_customerservice), and users require the `csm_ws_integration` role for full API access. External users with `sn_customerservice.customer` or `sn_customerservice.consumer` roles can access the case API endpoints.

Non-admin users require the `personalize_dictionary` role to access custom fields.

== Sync to {connection} from a Custom SQL View

To sync to {connection} from a custom SQL view, follow these steps:

. Navigate to your SQL view by selecting the *Data* tab and searching from the Data Workspace home page. Select the SQL view name.

. In the upper right corner, click the *more options* menu icon image:icon-more-10px.png[more options menu icon] and select *Sync to {connection}*.

. If this is the first sync you have created for {connection}, a pop-up authorization window appears. To give ThoughtSpot permission to send data to your {connection} account, fill out the *Instance url*, *Client id*, and *Client secret* found in the <<prerequisites,Prerequisites>>. In the authorization pop-up that appears, click *Allow*.



. Within ThoughtSpot, fill in the following parameters:

* Edit the *Pipeline name* if needed. By default, this field populates with _PL-[Answer Name]_.
* If you have more than one {connection} destination set up, then the *Destination* field appears, and you will have to select a {connection} destination from the dropdown available. However, if no destinations have been set up before or if you have only one {connection} destination, the *Destination* field will not appear.
* Select your {connection} *Object* from the dropdown menu. The available options are *Cases*, *Contacts*, *Incidents*, and *Tasks*.
* Select *Operation* from the dropdown menu. You can choose between *Create*, *Update*, and *Delete*.
+
NOTE: Not all objects will support all three operations.
* Map the *Source* and *Destination* columns from the dropdowns provided.


. By default, "Sync and save" is selected. Select *Save* to send your data to {connection}. Your data immediately appears in {connection}.

. [Optional] To set up a repeated sync, click *Schedule your sync* and select your timezone. From the options provided, choose whether the sync will occur every:

* _n_ minutes. You can choose to schedule a sync every 5, 10, 15, 20, 30, or 45 minutes.
* _n_ hours.
* _n_ days at a selected time. Note that you can choose not to send an update on weekends.
* week at a selected time and day.
* _n_ months at a selected time and date.

NOTE: Any sync over 50,000 rows may result in an execution timeout. For optimal performance, keep your sync to below 50,000 rows. If you're syncing a large number of rows and the sync fails, try applying filters like date filters to make your dataset smaller and then sync.


=== Roles

To enable the Contact and Case objects requires the Customer Service plugin (com.sn_customerservice), and users require the `csm_ws_integration` role for full API access. External users with `sn_customerservice.customer` or `sn_customerservice.consumer` roles can access the case API endpoints.

Non-admin users require the `personalize_dictionary` role to access custom fields.


== Sync to {connection} from the Data Workspace

To create a sync to {connection} from the Data Workspace, follow these steps:

. Select the *Data* tab.

. On the left menu bar, select *Sync*.

. Under the *Pipelines* tab, select "Create new pipeline". Note that if you do not already have a destination created to the intended destination app, you first need to create one in the *Destinations* tab.



. Fill in the following parameters:

* Edit the *Pipeline name* if needed. By default, this field populates with _PL-[Answer Name]_.
* All destinations available appear in the *Destination* dropdown.
* Select your *Source* data. Here you will pick an Answer or a custom SQL view to send through sync.
* Select the *Object* from the dropdown menu. The available options are *Cases*, *Contacts*, *Incidents*, and *Tasks*.
* Select the *Operation* from the dropdown menu. You can choose between *Create*, *Update*, and *Delete*.
+
NOTE: Not all objects will support all three operations.
* Map the source and destination columns from the dropdowns provided.

.  By default, "Save and sync" is selected. Select *Save* to send your data to {connection}. Your data immediately appears in {connection}.

. [Optional] To set up a repeated sync, click *Schedule your sync* and select your timezone. From the options provided, choose whether the sync will occur every:

* _n_ minutes. You can choose to schedule a sync every 5, 10, 15, 20, 30, or 45 minutes.
* _n_ hours.
* _n_ days at a selected time. Note that you can choose not to send an update on weekends.
* week at a selected time and day.
* _n_ months at a selected time and date.

NOTE: Any sync over 50,000 rows may result in an execution timeout. For optimal performance, keep your sync to below 50,000 rows. If you're syncing a large number of rows and the sync fails, try applying filters like date filters to make your dataset smaller and then sync.


=== Roles

To enable the Contact and Case objects requires the Customer Service plugin (com.sn_customerservice), and users require the `csm_ws_integration` role for full API access. External users with `sn_customerservice.customer` or `sn_customerservice.consumer` roles can access the case API endpoints.

Non-admin users require the `personalize_dictionary` role to access custom fields.

== Update and delete records in {connection}

To update and delete records in {connection}, the Sys Id field must be used as the mapping field. The following table shows the mapping needed for each object in {connection} to update or delete records in {connection}.

[options="header"]
|===
| ServiceNow object | Source column | Destination column

| Cases | Sys_id | Sys_id

| Contacts | Update and delete function not supported. | Update and delete function not supported.

| Incidents | Sys_id | Sys_id

| Tasks | Sys_id | Sys_id
|===

This Sys_id is a 32-digit value that can be found by right-clicking the individual value of an object. For example, by right-clicking a specific incident number like in the following image.

image::servicenow-sysid.png[Right-click an incident number to see Sys_id]

=== Failure to sync

A sync to {connection} can fail due to multiple reasons. If you experience a sync failure, consider the following causes:

* The underlying ThoughtSpot object was deleted.
* The underlying {connection} object was deleted.
* The column name was changed in either ThoughtSpot or {connection}, making it different to the column name setup in the mapping.
* There are data validation rules in {connection} which only allow data with a certain data type to be populated in the {connection} fields, but the columns being mapped onto {connection} from ThoughtSpot do not have the same or allowable data types.
* There is a mandatory field in {connection} which has not been mapped onto as a destination column when setting up the mapping in ThoughtSpot.


=== Manage pipelines

While you can also manage a pipeline from the *Pipelines* tab in the Data Workspace, accessing the *Manage pipelines* option from an Answer or view displays all pipelines local to that specific data object. To manage a pipeline from an Answer or view, follow these steps:

. Click the *more options* menu icon image:icon-more-10px.png[more options menu icon] and select *Manage pipelines*.

. Scroll to the name of your pipeline from the list that appears. Next to the pipeline name, select the *more options* icon image:icon-more-10px.png[more options menu icon]. From the list that appears, select:

* *Edit* to edit the pipeline’s properties. For example, for a pipeline to Google Sheets, you can edit the pipeline name, file name, sheet name, or cell number. Note that you cannot edit the source or destination of a pipeline.
* *Delete* to permanently delete the pipeline.
* *Sync now* to sync your Answer or view to the designated destination.
* *View run history* to see the pipeline’s Activity log in the Data Workspace.
+
image::ts-sync-manage-pipelines.png[More options menu for a pipeline]


'''
> **Related information**
>
> * xref:thoughtspot-sync.adoc[]
