= User actions and queries
:last_updated: 11/05/2021
:linkattrs:
:experimental:
:page-aliases:
:page-layout: default-cloud
:description:

Many actions that you do in ThoughtSpot generate queries. Use the following reference to find out the common actions that generate queries, and the ones that don't.

== User actions that generate queries

Here are common user actions, and the queries that they generate.

[cols="25%,25%,50%",frame=ends,grid=rows]
|===
|User action |Number of queries |Details

|Opening a Liveboard
|Multiple queries, various times
|A Liveboard may have quite a large number of visualizations. When a user opens a Liveboard, the system sends a request for several queries to render the first several visualizations on the screen. As the user scrolls downward in the Liveboard, the system makes additional requests for queries that correspond to further visualizations and charts to render on the screen.

|Opening an Answer in the table view
|Multiple queries, at the same time
|One (1) query fetches the table data.

Additionally, for every column up to a maximum of 1000 columns, the system requests a summary query. See the section What are table summaries? for instructions on how to turn off these additional queries.

|Opening an Answer in the chart view
|Single query*
|One (1) query fetches the chart data.

*The exception is the Pivot table chart; it generates several queries depending on the structure of the pivot. See What is a pivot table? for more information.

|Search on enter
|Multiple queries
|One (1) query fetches the chart data.

In Instant Search, when the user updates the text and the Search suggestion in the Sage Search bar, the system requests a query for every click on enter, and an additional query for each summary. See the section What are table summaries? for instructions on how to turn off these additional queries.

|Adding an existing column to search
|Single query
|By clicking on the left panel, the user adds a column from the current data source to the search.

The system fires 1 (one) query on enter.

|Adding a formula to search
|Single query
|When the user changes the answer by adding a previously defined formula on the data source from the left panel and clicks enter, the system generates a single query.

|Adding a filter to an answer
|Single query
|When the user successfully adds a filter to an answer from the left panel, the system requests one query on enter.

|Changing a filter
|Single query
|When a user successfully changes an existing filter, the system requests one query.

|Creating or changing a formula
|Single query
|When the user either creates or changes a formula on an answer, the system generates one query.

|Toggling between table and chart views
|Single query, or no queries
a|Toggle view from table to chart without modifications.

- When you toggle from a table to a chart the first time, the system generates a single query.

- When you toggle back to the table, the system does not send additional queries.

|Toggling between table and chart views, with modifications
|Single query, or multiple queries
a|Toggle view from table to chart with modifications.

- When you toggle from a table to a chart the first time, the system generates a single query.

- When you make changes to the chart, such as sort or filter, the system generates a single query.

- When you toggle back to the table, the system generates a query and additional queries for each headline summary.

|Toggling between a chart and a table
|Multiple queries, or no queries
a|Toggle view from a chart to a table without modifications.

- When you toggle from a chart to a table, the system generates a query and additional queries for each headline summary.

- When you toggle back to the chart, the system does not send additional queries.

|Toggling between a chart and a table, with modifications
|Multiple queries, or a single query
a|Toggling a view from a chart to a table with modifications.

- When you toggle from a chart to a table, the system generates a query and additional queries for each headline summary.

- When you make changes to the table, such as sort or filter, the system generates a query and additional queries for each headline summary.

- When you toggle back to the chart, the system generates a single query.

|Changing a chart type
|Single query* (usually)
|When the user changes the chart type, the system generates a single query. Two exceptions are pivot tables, and stacked charts; both use multiple queries.

|Opening a pivot table
|Multiple queries initially, and more with drill-down
|The user opens a pivot table chart. The system generates the necessary number of queries initially, based on the structure of the pivot. If the user drills down further, the system generates more queries, depending on the dimensions of the x-axis and y-axis. See information on pivot tables.

|Transforming a table in an Answer or inside a Liveboard
|Single query for each transformation
a|The user transforms a table in Answer or on a Pinboard Viz. When changing the aggregation, filtering and sorting from the column header, filtering from the contents of cells.

- Sorting: the system generates a single query for each sort

- Changing the aggregation: the system generates a single query for each aggregation change

- Filtering: the system generates a single query for each filter

|Following up
|Single query
|Every time clicks on a follow-up Explore, the system generates a single query.

|Exploring to update an answer
|Single query
|Every time that a user explores to update the chart or answer, the system generates a single query.

|Drilling down
|Single query
|When a user drills down on an answer or visualization and selects a column, the system generates a single query.

|Schedule Liveboard
|Multiple queries
|When a user schedules a Liveboard without row-level security (RLS), the system generates the same number of queries required by the Liveboard.

|Scheduling a Liveboard, with RLS
|Multiple queries
|When a user schedules a Liveboard with multiple row-level security rules, such as 2 RLS rules for 2 groups of users, the number of queries that the system generates depends on the number of user groups and the number of queries required by the Liveboard.

|Adding a new chart to the Liveboard
|Multiple queries
|When the user adds a new chart to the Liveboard and then returns to the Liveboard view through the link at bottom of the screen, the system generates the same number of initial queries as there are charts that appear in the viewport (on the screen) when the Liveboard loads.

|Updating chart and return to Liveboard
|Multiple queries
|When a user edits a chart and makes several changes, then updates or closes the chart and returns to the Liveboard, the system generates queries for each change on enter during the editing time, and an additional query when the user saves the chart and returns to the Liveboard.

|Opening the filter widget
|Query for each unique value
|When the user opens the filter widget to either include or exclude specific values, the system generates a query for each unique value of the filter.

|Showing underlying data in a cell
|Single query
|When the user clicks to show the underlying data of a cell, the system fires a single query.

|Undoing or redoing in a saved answer
|Single query for each action
|When the user presses the Undo / Redo button in a saved answer, each press results in a query.

|Downloading an answer as a chart
|Single query
|When downloading an answer as a chart, the system triggers 1 query for each chart type.

|Downloading any answer as a chart inside a Liveboard
|Multiple queries
|One (1) query for each chart Answer.

|Downloading Liveboard as PDF
|Multiple queries
|The number of queries is equal to the sum of all queries generated from each tile in the lifeboard.
|===

== User actions that don't generate queries

Here are common user actions that *don't* generate queries:

- SpotIQ-generated queries
+
NOTE: If you save the results of a SpotIQ query as a Liveboard, you will be charged the standard Liveboard usage rate when you open it.

- Downloading a Liveboard visualization as a table in any format
- Downloading an answer as a table in any format, NOT within a Liveboard
- Searching answers
- Accessing system-default Liveboards
- Importing TML of an answer or a Liveboard
- Exporting TML of an answer or a Liveboard without data (associated objects)
- Creating a connection to an external data warehouse
- Updating a connection to an external data warehouse by adding a new table with the string data type (triggers Sage indexing)
- Inspecting data in Data samples tabs after adding multiple tables in a worksheet with joins between them
- Sharing an object with others

== How do table summaries affect queries?

When you open an answer in a table view, the system generates individual queries for summary (aggregate) calculations and sends them to the CDW.  Each time the system refreshes the screen, it initiates the queries for refreshing these summaries.
To reduce the number of queries, ThoughtSpot has two options:

=== Turning off summaries on individual Answers

ThoughtSpot recommends turning off the summary function for the table if you plan limit the number of queries, at least temporarily.

. Click the table in the Liveboard, to open it in Answer mode.
. Click the gear icon (chart configuration).
. Under the Edit table heading, select *Settings*.
. Under Display, de-select the *Column summary* option.

=== Turning off summaries at the System level

Alternatively, in the new user experience,  users with administrative privileges can turn off columns summaries for the entire site through the Admin Console. While this action does not change existing tables, all new tables will not feature calculated summaries.

. In the Admin console, under Application settings, select *Search & SpotIQ*.
. Across from the Search settings heading, click *Edit*.
. Click the *Table summaries* option.
. Set the option to the *Disabled* state.
. Click *Save* to update the configuration for future answers.

== How do Liveboards affect queries?

When you have a Liveboard with a large number of visualizations, ThoughtSpot does NOT generate all of them at the same time. Instead, the system only requests queries for the visualizations that appear in the initial viewport of the screen when it renders the Liveboard.  As you scroll down, additional queries are sent to render the newly in-view visualizations.
So, the initial query request is approximately the same as the number of visualizations that appear in the Liveboard before the user scrolls downward. Both tables and pivot tables require multiple queries, as described elsewhere in this article.

== How do pivot tables affect queries?

A pivot table is a very powerful visualization option in ThoughtSpot. It is essentially a statistical visualization that summarizes (aggregates) and reorganizes (sorts) selected columns and rows in a table format. The number of independent queries that the system requires to generate a pivot table depends on the number of columns and rows of data in the pivot table, and also on the variability and the granularity of the underlying data.
