= ThoughtSpot Tutorials for Snowflake Partner Connect
:last_updated: 02/02/2021
:linkattrs:
:experimental:

Explore these tutorials to learn how to model your data after connecting to your Snowflake database.

When you create a connection to Snowflake in ThoughtSpot, any data modeling or table joins are inherited automatically.

If there are no table joins in your Snowflake connection, you can easily create them in ThoughtSpot.

The following example shows how the table joins were created in the Sales table of the Retail Sales worksheet, available in your *try.thoughtspot.com* account created through Snowflake Partner Connect.

== Creating table joins

The joins in the Sales table were created by doing the following:

. Click *Data* in the top navigation bar.
. Click the *Tables* tab at the top of the page.
. Click the *Sales* table.
+
The Columns view of the Sales table appears.

. Click the *Joins* tab.
. Click *+Add join*.
+
The Add Join window appears.

. In the Add Join window, use the drop-down menus to make the following selections:
 ** For Destination Table, select *Products*.
 ** For Source Columns, select *Product_Key*.
 ** For Destination Columns, select *Product_Key*.

+
image::snow-add-join.png[]
. Click *Next*.
. Enter the name _Product_Key - Product_Key_, a description for your join (optional), and click *Next*.
+ image:snow-add-join-name.png[]
+
NOTE: You can use any name you want.
The names we've chosen for this tutorial match those in the actual schema for this dataset on try.thoughtspot.com.
+
The first join is created.
Now you will add the other joins.

. Click *+Add join*.
. In the Add Join window, use the drop-down menus to make the following selections:
 ** For Destination Table, select *Customers*.
 ** For Source Columns, select *Customer_Key*.
 ** For Destination Columns, select *Customer_Key*.

+
image::snow-add-join2.png[]
. Click *Next*.
. Enter the name _Customer_Key - Customer_Key_, a description for your join (optional), and click *Next*.
+ image:snow-add-join-name2.png[]
. Click *+Add join*.
. In the Add Join window, use the drop-down menus to make the following selections:
 ** For Destination Table, select *Stores*.
 ** For Source Columns, select *Store_Key*.
 ** For Destination Columns, select *Store_Key*.

+
image::snow-add-join3.png[]
. Click *Next*.
. Enter the name _Store_Key-Store_Key_, a description for your join (optional), and click *Next*.
+ image:snow-add-join-name3.png[]
. Click *+Add join*.
. In the Add Join window, use the drop-down menus to make the following selections:
 ** For Destination Table, select *Dates*.
 ** For Source Columns, select *Date_Key*.
 ** For Destination Columns, select *Date_Key*.

+
image::snow-add-join4.png[]
. Click *Next*.
. Enter the name _Date_Key - Date_Key_, a description for your join (optional), and click *Next*.
+ image:snow-add-join-name4.png[]
+
Now that all four table joins are created, the schema looks like this: + image:snow-schema.png[]

=== Searching joined tables

You can easily search the joined tables, without having to create a worksheet.

To search the joined tables, do the following:

. Click *Search*.
. Click the _Retail Sales_ data source, and click *Choose sources*.
. Select all the tables you just joined (Customers, Dates, Products, Sales, and Stores) and click *Close*.
. In the search bar, enter *sales_dollar_amount*, *store_region*, and *monthly _Date in Dates_*.
+ image:date-in-dates.png[]
+
The search results look like this: + image:snow-search-results.png[]
+
NOTE: When Monthly is a native keyword, it will work on any timestamp.
For the purposes of this example, we're using monthly as the date, from the Dates table.

. To confirm that the search is honoring the table joins, click the Query details icon image:icon-information-20px.png[query details icon], to the right of the chart.
+ image:partner-connect-query-details.png[]
. To confirm the search is bridging three different tables to create a result, click *Query visualizer*.
+ image:partner-connect-query-visualizer.png[]

=== Best practices for data modeling

Here are some examples of how you can model your data to enhance searchability:

* Change column names
* Add synonyms for columns

In the following example, the _Sales_Dollar_Amount_ column was renamed to Sales and the synonyms of _Revenue_ and _Dollars_ were added.
+    image:snow-model-best.png[]

These are just a couple of examples of things you can do.

For more information about data modeling, see: xref:data-modeling-settings.adoc[Overview of data modeling settings]

== Creating a worksheet

A worksheet is a curated dataset built for ad-hoc analysis, that allows you to translate data from a database into the language of your business users.

Examples of things you can do in a worksheet include:

* Removing columns that aren't needed
* Adding data labels and synonyms
* Adding calculations, such as margin

The worksheet based on the Sales table on *try.thoughtspot.com* was created by doing the following:

. Click *Data*.
. Click the more options icon image:icon-ellipses.png[more options menu icon], and select *Create worksheet*.
+  image:worksheet_create_icon.png[]
. Click the *+* icon, next to Sources.
. Check the box next to all five of the tables from the Retail dataset in your schema.
+ image:partner-connect-tables-worksheet.png[]
. Make sure the default setting of *Apply joins progressively* is selected.
This ensures that the search uses only the tables that are required.
. Click *Close*.
. In the Data view, click the name of the Customers table to reveal all of the columns in that table.
. Double-click each column from the Customers table that you want to include in the worksheet.
+
Include these columns:

 ** Customer_Type
 ** Customer Name
 ** Customer_Gender
 ** Customer Region
 ** Customer State
 ** Customer City
 ** Customer Zip Code
 ** Customer County

. Use the same process to select columns from the other tables to include in the worksheet.
+
From the Dates table, include this column:

 ** Date

+
From the Products table, include these columns:

 ** Product_Description
 ** Category_Description
 ** Department_Description

+
From the Sales table, include these columns:

 ** Sales_Dollar_Amount
 ** Cost_Dollar_Amount
 ** Gross_Profit_Dollar_Amount

+
From the Stores table, include these columns:

 ** Store_Name
 ** Store_Region
 ** Store_State
 ** Store_City
 ** Store_Zip_Code
 ** Store_County + image:partner-connect-columns-worksheet.png[]

+
NOTE: As a best practice, you would not select a key from a table when creating a worksheet, because you would not want to search for the key.

. Click the pencil icon image:icon-edit-20px.png[edit icon] next to the current name of your worksheet, enter the name *Retail Sales*, and click *Done*.
. Click the more options icon image:icon-ellipses.png[more options menu icon], and select *Save*.
+
Now, let's add a percent gross margin formula to the worksheet.

. Click *Edit Worksheet*.
. Next to Formulas, click the plus icon image:icon-add-20px.png[plus icon].
. In the formula window, do the following:
 .. In the top field, enter the formula title: *% Gross Margin*.
 .. In the next field, enter this formula:
+
----
sum ( gross_profit_dollar_amount ) / sum ( sales_dollar_amount ) * 100
----

 .. Click *Save*.
+ image:partner-connect-worksheet-formula.png[]
. Save the worksheet with the formula added, by clicking the more options icon image:icon-ellipses.png[more options menu icon], and selecting *Save*.
. Click *Data*, and click the Retail Sales worksheet.
. In the Columns view, make sure that the % Gross Margin formula has the following settings:
 ** For DATA TYPE: *DOUBLE*
 ** For COLUMN TYPE: *MEASURE*
 ** For AGGREGATION: *AVERAGE*
. Save the worksheet with the updated formula settings, by clicking the more options icon image:icon-ellipses.png[more options menu icon], and selecting *Save*.

=== Best practices for worksheets

The best practices for data modeling also apply to worksheets.

The example here includes:

* Changed column names
* Synonyms for columns
* % Gross Margin formula + image:partner-connect-worksheet-best.png[]

=== Adding a currency and geo map to a worksheet

To further enhance the usability of a worksheet, you can add a specific currency type to monetary values, and a geographic map to regions in your data.

Using the Retail Sales worksheet example, here's how geo maps and currency could be added:

. Click *Data*, and click the *Retail Sales* worksheet.
. In the Columns view, find the Sales column and click *None* in the Currency Type column.
. In the Specify Currency Type window, select *Specify ISO Code* and, then select *USD* from the drop-down menu.
+ image:partner-connect-currency.png[]
. In the Columns view, find the Store_State column, and click *None* in the Geo Config column.
. In the Specify Geographic Configuration window, select *Specify Sub-nation region*, keep the default country of United States, and then select *State*.
+ image:partner-connect-geo-config.png[]
. Click *Save Changes*.
+
Now that both currency and geographic types are set, you can see those changes reflected when you search the Retail Sales worksheet.

. Click *Search*.
. Click *Choose sources*.
. Deselect any tables previously selected (if needed), select only the *Retail Sales* worksheet, and click *Close*.
. In the search bar, enter: *sales* *store state* and press tab.
+
The initial search results appear, but without labels for each state.
+ image:partner-connect-geo-curr-search-nolabels.png[]
+
The final step is to add the labels.

. Click the Edit chart configuration icon image:icon-gear-20px.png[gear icon].
. In the Customize panel, click the *Total Sales* tile.
. In the Edit column panel, select the *Data Labels* checkbox.
+
Now in the search results, you can see labels with the state name and total sales in US dollars.
+ image:partner-connect-geo-curr-search.png[]

== Related information

* xref:embrace-snowflake-partner.adoc[ThoughtSpot in Snowflake Partner Connect]
* xref:embrace.adoc[Embrace overview]
* xref:embrace-snowflake-add.adoc[Add a Snowflake connection]
* xref:embrace-snowflake-modify.adoc[Modify a Snowflake connection]
