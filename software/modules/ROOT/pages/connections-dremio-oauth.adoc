= Configure OAuth for a {connection} connection
:experimental:
:last_updated: 1/25/2022
:linkattrs:
:connection: Dremio
:description: Learn how to configure OAuth for a Dremio connection in ThoughtSpot.
:jira: SCAL-199788

ThoughtSpot supports OAuth for a connection {connection} Cloud.

NOTE: OAuth cannot be used to connect to {connection} Software.

To configure OAuth for {connection}, you create an app in the Identity Provider and use the appâ€™s credentials to register it in {connection} as an external token provider. Once these steps are completed, {connection} will allow connections coming in with the JWT issued by the IdP.

NOTE: For OAuth, we recommend checking the {connection} link:https://docs.dremio.com/cloud/security/authentication/idp/[documentation] to confirm any IDP support and their details. This article documents only the most frequently set-up IDP.

[#part-1]
== Part 1: Configuring the IdP with Okta

The following steps detail the configuration of IdP with Okta as an example. You can set up any other OpenID Connect (OIDC)-based IdP providers following a similar process. For details, refer to the respective documentation for those.

To configure the IdP with Okta, do the following:

. Log in to the Okta console with a user having administrator privileges. Navigate to the *Applications* page in the console and select *Create App Integration*.
+
image::dremio-oauth1.png[Click Create App Integration on the Applications page]
+
. For sign-in method, choose *OIDC - OpenID Connect*.
. For application type, choose *Web Application*
. Select *Next*.
. Under Grant type, make sure *Authorization Code* is selected.
+
image::dremio-oauth2.png[Select Authorization Code]

. For Sign-in redirect URIs, add the ThoughtSpot redirect URI for the application.
+
It should follow this format:
+
`\https://<your-thoughtspot-instance-host>/callosum/v1/connection/generateTokens`
+
image::dremio-oauth3.png[Add the ThoughtSpot redirect URI]

. Assign the application to everyone in the organization or to specific groups. This step may vary for other IdPs.
+
image::dremio-oauth4.png[Assign the application as needed]
. Collect the client credentials from the application home page and make a note of them. These will be required later when adding a {connection} connection in ThoughtSpot.
+
image::dremio-oauth5.png[Make a note of the client credentials]
. Go to menu:Security[API], and make a note of the value for Audience. This is required in a later step
for configuring the OpenID well-known URI for the authorization server.
+
image::dremio-oauth6.png[Make a note of the value for Audience]
+
For Okta, it should follow this format:
+
`\https://<organization>.okta..com/oauth2/<unique_id>/.well-known/oauth-authorization-server`
. Open the URL in a browser and make a note of the values for the following parameters:
- Issuer
- Authorization endpoint
- JWKS URI
- Token endpoint

[#part-2]
=== Part 2: Adding external token provider in {connection}

To add an external token provider in {connection}, do the following:

. Log in to the {connection} cloud console and navigate to Organization Settings.
. From the menu, select *External Token Providers*.
. Select *Add Provider* and fill in the details of your IdP.
+
image::dremio-oauth7.png[Enter details from your IDP]
+
For User Claim Mapping, use the value of the claim in the JWT issued by the IdP that contains the value of the username in {connection}.
+
Example token generated by Okta:
+
image::dremio-oauth8.png[Sample token]

'''
> **Related information**
>
> * https://docs.dremio.com/cloud/security/authentication/external-token/[External Token Providers^] (Dremio documentation)
> * xref:connections-dremio-add.adoc[Add a {connection} connection]
> * xref:connections-dremio-edit.adoc[Edit a {connection} connection]
> * xref:connections-dremio-remap.adoc[Remap a {connection} connection]
> * xref:connections-dremio-delete-table.adoc[Delete a table from a {connection} connection]
> * xref:connections-dremio-delete-table-dependencies.adoc[Delete a table with dependent objects]
> * xref:connections-dremio-delete.adoc[Delete a {connection} connection]
> * xref:connections-dremio-reference.adoc[Connection reference for {connection}]
