= RHEL installation prerequisites
:last_updated: 6/30/2020
:linkattrs:

Prepare the system and ThoughtSpot clusters for installation.

[width="100%",options="header",cols="5%,95%"]
|===
| &#10063;
| <<set-up-hosts,1.
Set up hosts for the ThoughtSpot cluster>>

| &#10063;
| <<partition-hosts,2.
Partition the hosts>>

| &#10063;
| <<install-rhel,3.
Install RHEL version 7.7 or 7.8 on all hosts>>

| &#10063;
| <<linux-kernel-version,4.
Ensure that your Linux kernel is on version 3.10.0-1127.19.1>>

| &#10063;
| <<enable-hosts,5.
Enable the hosts to download RHEL packages>>

| &#10063;
| <<enable-ansible,6.
Enable an Ansible Control Server>>

| &#10063;
| <<disable-selinux,7.
Disable SELinux>>

| &#10063;
| <<tmp-permission,8.
Ensure tmp has permission 777>>

| &#10063;
| <<proc,9. Ensure /proc mount point flags are compatible>>

| &#10063;
| <<etc-sudoers,10. Remove Defaults requiretty from /etc/sudoers>>
|===

[#set-up-hosts]
== Set up hosts for the ThoughtSpot cluster

Set up hosts for the ThoughtSpot cluster on your chosen platform.
Please refer to the relevant deployment sections in our documentation for the exact specification for the hosts: CPU, memory, and disks.

* ThoughtSpot-certified hardware appliance manufactured by xref:installing-dell.adoc[DELL]
* ThoughtSpot-certified hardware appliance manufactured by xref:installing-the-smc.adoc[SMC]
* xref:configuration-options-aws.adoc[Amazon Web Services (AWS) EC2]
* xref:configuration-options-gcp.adoc[Google Cloud Platform (GCP)]
* xref:vmware-intro.adoc[VMware]
* xref:configuration-options-azure.adoc[Microsoft Azure]

[#partition-hosts]
== Partition the hosts

Ensure that all ThoughtSpot hosts have the following partitions on the root drive.

Note that the size of the root drive on appliances is limited to 200GB;
the partition requirements are therefore somewhat different when compared to the other environments.

[width="100%",options="header",cols=5*]
|====================
| Platform |Partition|Drive type|Description|Minimum size
.2+| Hosts in AWS, GCP, Azure, and VMWare | OS partition | SSD (root drive) | Root partition for OS, /tmp| 100GB Allocate at least 50GB to /tmp
| Export partition | SSD (root drive) | Stores ThoughtSpot objects, hdfs logs, service logs, and so on |200GB
.2+| Hosts on ThoughtSpot-certified hardware appliances | OS partition | SSD (root drive) | Root partition for OS, /tmp |80GB
Allocate at least 50GB to /tmp
| Export partition | SSD (root drive) | Stores ThoughtSpot objects, hdfs logs, service logs, and so on |	100GB
|====================

[#install-rhel]
== Install RHEL on hosts

ThoughtSpot is certified with RHEL versions 7.7 and 7.8;
we *do not* support other versions of RHEL, including 8 and 8.1.
Install RHEL version 7.7 or 7.8, and ensure that your <<linux-kernel-version,linux kernel version>> is 3.10.0-1127.19.1.

[#linux-kernel-version]
=== Linux kernel version

Your Linux kernel *_must_* be on version 3.10.0-1127.19.1.
RHEL 7.7 and 7.8 used to come with a Linux kernel of version 3.10.x, which has a bug that causes nodes to reboot unexpectedly.
The default Linux kernel version for RHEL 7.7 and 7.8 is now 3.10.0-1127.19.1.
However, you may have an older RHEL 7.7 or 7.8, with a Linux kernel of version 3.10.x.
You must upgrade to 3.10.0-1127.19.1.
If you have trouble upgrading your Linux kernel to version 3.10.0-1127.19.1, xref:contact.adoc[contact ThoughtSpot Support].
This is a requirement for *_all_* platforms: appliance, cloud, and VMware.

WARNING: If Linux kernel version is not 3.10.0-1127.19.1, you may run into unexpected node reboots and possible loss of data.

[#enable-hosts]
== Enable the hosts to download RHEL packages

*Repositories*

[#yum-repositories]
* *Yum repositories*: you must enable the following Yum repositories in your cluster: `epel`, `nux-desktop`, `pgdg95`, `rhel`, `rhel-optional`, `rhel-extras`.

[#python-repositories]
* *Python repository*: for Python, ensure the machine is able to reach the `PyPI` repository located at https://pypi.python.org/.

[#r-repositories]
* *R repository*: for R, ensure the machine is able to reach the `CRAN` repository located at https://cran.rstudio.com/.

Make sure that you can download RHEL packages to all hosts, either from the <<official-repositories,official package repositories>>, or from a <<mirror-repositories,mirror repository>> owned and managed by your organization.

If you cannot access the RHEL repositories, there is no mirror repository in your organization, or you are unable to access Yum, Python, or R repositories, please xref:contact.adoc[contact ThoughtSpot Support].

[#official-repositories]
*Official package repositories*

If the hosts of your ThoughtSpot cluster can access external repositories, either directly or through a proxy, your cluster is online.
You can then proceed to download <<yum-repositories,Yum>>, <<python-repositories,Python>>, and <<r-repositories,R>> package repositories.

[#mirror-repositories]
*Internal mirror repository*

If the hosts of your ThoughtSpot cluster have access to an internal repository that mirrors the public repositories, copy the <<yum-repositories,Yum>>, <<python-repositories,Python>>, and <<r-repositories,R>> package repositories to your hosts.

[#enable-ansible]
== Enable an Ansible Control Server

Configure an Ansible Control Server, on a separate host, to run the Ansible playbook that ThoughtSpot supplies.
You must install both `rsync` and Ansible on the Ansible Control Server host.

[#disable-selinux]
== Disable SELinux or run it in permissive mode

ThoughtSpot does not support policies that enforce SELinux.
We recommend that you disable SELinux, or run it in permissive mode.

[#tmp-permission]
== Ensure tmp has permission 777

The `/tmp` directory must have the `777` permission. If you mount the `/tmp` directory as a separate partition, it must NOT have the `noexec` flag set.

[#proc]
== Ensure /proc mount point flags are compatible

You cannot mount the /proc mount point with the `hidepid` flag. You must mount it without that flag.

[#etc-sudoers]
== Remove Defaults requiretty from /etc/sudoers

The `/etc/sudoers` file must not have the `Defaults requiretty` line. This line can cause cluster creation to fail.
