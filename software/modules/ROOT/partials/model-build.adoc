[#build-model]
ifndef::spotter[]
== Building your {model}
endif::[]
ifdef::spotter[]
== Model your data
endif::[]

After creating your {model}, you need to add the sources that contain the data.
A source is another name for a table. You do that using the {model} editor. If you chose an existing model, you can make changes to your model.

image::model_empty.png[Create a Model]

The sources you choose are typically related to one another by foreign keys.

The first step to building your {model}, is to add tables.

=== Adding tables

To add tables to your {model}, do the following:

. Drag tables from the list on the left, and drop them into the right pane.
+
image::model_tables.png[Model populated with tables]


==== Suggested joins

If the tables you added to your {model} were joined previously, a join suggestion appears.

image::model_tables_join_suggestion.png[Suggested join between tables]

You can choose whether to keep, modify or remove the suggested join.

- Click the join icon image:model_join_icon.png[join icon], then select one of the following options:
.. To keep the join, click *Accept Join*.
.. To modify the join, click *Edit Join*.
... Make your changes and click *Save*. For more information, see step 2 of <<add-joins,Adding joins>>.
.. To remove the join, click *Clear Join*.

[#add-joins]
=== Adding joins
. To add a new join between tables, do one of the following:

- Select the More menu image:model_table_join_more.png[Model more menu] in the upper right of a table, and select *Add Join*.
- Hover over the table until you see a *\+* appear on the edge of the table, then click the *+* and drag to the table you want to join.
. In the _Create Join_ window for _Table 2_, select the table you want to join to the first table (_Table 1_).
. For _Column from Table 1_, select the column you want to join to another column in _Table 2_.
. For _Column from Table 2_, select the column in _Table 2_ which you want to join to the selected column in _Table 1_.
. For _Join Type_, select a join type. Options include:
- INNER image:model_join_icon.png[inner join]
- FULL OUTER image:model_join_full_outer_icon.png[outer join]
- LEFT OUTER image:model_join_suggestion_icon.png[left outer join]
- RIGHT OUTER image:model_join_right_outer_icon.png[right outer join]
. For _Cardinality_, select the cardinality. Options include:
- Many:1
- 1:Many
- 1:1
. Click *Save*.
+
The join is created.
+
image::model_tables_joined.png[Join created]

. Add additional tables and joins, as needed.
. (Recommended) Name your {model} by clicking *Add name* and entering a name.
. (Optional) Add a description of your {model} by clicking *Add description* and entering a description.
. When you are finished adding tables and joins to your {model}, the next step is to add columns.

==== Global and local joins

{model}s support both global and local joins. It's helpful to understand the difference.

- *Global joins* are created between two tables in a connection and they are available to any {model} created in that connection. If you see a join suggestion when you create a model, it means that join is a global join.
- *Local joins* are created in a specific {model} and they are only available in that {model}.

=== Adding columns

To add columns to your {model}, do the following:

. Click the *Columns* tab.
+
image::model_columns.png[Model columns tab]
+
Table names are highlighted in blue, and their associated columns appear underneath them.

. Add columns by doing either of the following:
- To add all the columns from a table, drag the table name from the list on the left and drop it into the right pane.
- To add an individual column from a table, drag the column name from the list on the left and drop it into the right pane.

+
image::model_columns_added.png[Columns added to Model]

. (Optional) Edit column properties, using either of the following methods:
.. For an individual column:
... Click the column property you want to edit, and make your changes.
.. For multiple columns:
... Click the checkbox next to the columns you want to edit.
... Click the *Edit* menu, and select the property you want to edit.
... In the window that opens, select the option you want and click *Update*.
. To save the columns in your {model}, select *Save changes*.
+
You are prompted to edit the title and description of your {model}.
. Edit the title and description if needed.
. Click *Save*.
+
Your model is saved, and you have the option to add formulas, filters, parameters, and adjust settings.
. If you don't want to add those now, select *Exit data model*.

==== Sorting and filtering columns

You have the option to sort any column in ascending or descending order, as well as apply a filter to a column by selecting possible values of the column.

image::models_sort_filter.png[Sort columns]



To sort a column, do the following:

. Click a column heading
. From the pop-up menu, select either *Sort ascending* or *Sort descending*.

To filter a column, do the following:

. Click a column heading
. From the pop-up menu, select *Filter*.
. In the _Edit filter_ window, select the values you want to filter by and click *Apply*.
+
A label appears above the table indicating the values used to filter the column.
+
image::models_sort_filter_2.png[Filtered values label]
+
You can delete the filter by hovering over the label and clicking the (X).
+
In the _Edit filter_ window, you also have the following options to use when editing or adding a filter:

- Select all
- Clear
- Search
- Show selected

+
NOTE: Sort and filter states are not saved when you save your Model, however they do persist when you switch between tabs of the {model} editor.

=== Adding formulas

To add formulas to your {model}, do the following:

. Click the *Formulas* tab.
. Click *Add Formula*.
+
. Create a name for your formula.
. Enter a formula, using the formula assistant (at right) if needed.
+
image::model_formulas_2.png[Enter a formula]
+
With the formula assistant, you can see a list of formula operators with examples.
+
If you want to change what your formula returns, select the Advanced settings button image:icon_formula_gear_32px.png[Formula advanced settings].
+
Depending on your formula, you may be able to change:

- Data type: Determines the type of data that the formula generates. For example, use date for an add_days formula.
- Measure or attribute: Determines if the output of the formula is a measure or an attribute. For example, choose attribute for a formula that generates age groups, and choose measure for a formula that generates profit.
- Aggregation: Determines the default aggregation of the formula output. For example, choose min to see minimum profit.

. Click *Save*.
. Click *Save changes*.

=== Adding filters

To add filters to your {model}, do the following:

. Click the *Filters* tab.
. Click *Add filter*.
. Choose the column you want to filter on.
+
image::model_filters.png[Filter a column]
. Select the values to include in your Answer.
+
image::model_filters_2.png[Select values]
. If you want to exclude values, select *Exclude* and choose values to exclude.
+
You can also include values in bulk, by clicking *+ Add values in bulk*, and adding values separated by a comma (,) or a semicolon (;) or by putting them on separate lines.
. Click *Submit*.
. Click *Save changes*.

CAUTION: ThoughtSpot recommends to not use more than 1,000 filter values in a {model}.

=== Adding parameters

To add parameters to your {model}, do the following:

. Click the *Parameters* tab.
. Click *Add Parameter*.
+
image::model_parameters.png[Add a parameter]
. In the _Parameter name_ text box, enter a name for your Parameter. This name should be unique for the object, and easy for users to understand.
. Optionally, enter a description for the Parameter in the _Add a description_ text box. Use this field to add additional information users might need before using this Parameter in their analysis. It is a best practice to use this field to specify the formulas this Parameter is used in, in addition to any other information you add.
. Under _Data settings_, specify the data type the Parameter must be: Integer, Double, String, Boolean, or Date.
ifndef::spotter[]
For more information about data types, refer to xref:data-types.adoc[Data types].
endif::[]
. For integer, double, or date data types, specify the allowed values: Any, List, or Range. For the string data type, specify either _Any_ or _List_.
+
[horizontal]
Any::
Allows any value within the data type's constraints.
List:: Allows values only in the list you create. Enter a value in the *Enter value...* text box, and optionally enter what the value should display as in the *Display as...* text box. To add more values, select *+ Add row*. To delete values, select the *x* to the right of the row the value is in.
+
image::parameter-list.png[Create a list of allowed values]
Range:: Allows values only within the range you specify. In the *Minimum value* and *Maximum value* text boxes, specify the values the range begins and ends with.
+
image::parameter-range.png[Create a range of allowed values]
. For the boolean data type, optionally set custom names for `true` and `false`; for example, `0` and `1`.
. Set the default value for your Parameter. In the default value text box, enter the value this Parameter should default to. For the boolean data type, the *Default value* option is a dropdown.  `true` and `false` are the only options.
. Select *Save*.

=== Settings

You can set properties for your model, including join rules and security.

To set properties for your {model}, do the following:

. Click the *Settings* tab.
. For _Data model join rule_ choose one of the following:
- Apply joins progressively (recommended for most cases)
- Apply all joins
. For _Security_ you have the option to disable row level security for your data model.
+
image::model_settings.png[Model settings]
+
Often, a {model} includes several dimension tables and a fact table.
With progressive joins, if your search only includes terms from the fact table, you can see all of the rows that satisfy your search.
But as you add terms from dimension tables, the total number of rows shown may be reduced, as the joins to each dimension table are applied.
It works like this:

* If you choose *Apply joins progressively (recommended for most cases)*, joins are only applied for tables whose columns are included in the search.
* If you choose *Apply all joins*, all possible joins are applied, regardless of which tables are included in the search.
+
When using *Apply joins progressively*, the number of rows in a search using the {model} depends on which tables are part of the search.
The {model} contains the results of a defined query in the form of a table.
So if a particular dimension table is left out of the search, its joins are not applied.
. Click *Save changes*.
. In the _Describe your model_ window, name and describe your model (if you haven't already), and click *Save*.
. Click *Exit data model*.

